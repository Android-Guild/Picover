name: Pull Request verification
on: pull_request

jobs:
  branch-name:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Check correct branch name
        run: ./.github/scripts/branch/checkBranch.sh

  commit-message:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          ref: ${{github.event.pull_request.head.sha}}
      - name: Check correct commit message
        run: ./.github/scripts/commit/checkCommitMessage.sh

  lint-check:
    uses: ./.github/workflows/setup_docker_and_execute_command.yml
    with:
      command: ./gradlew lintDebug
    secrets: inherit

  ktlint-check:
    uses: ./.github/workflows/setup_docker_and_execute_command.yml
    with:
      command: ./gradlew ktlintCheck

  build:
    uses: ./.github/workflows/setup_docker_and_execute_command.yml
    with:
      command: ./gradlew assemble
    secrets: inherit

  tests:
    uses: ./.github/workflows/setup_docker_and_execute_command.yml
    with:
      command: ./gradlew test
    secrets: inherit
